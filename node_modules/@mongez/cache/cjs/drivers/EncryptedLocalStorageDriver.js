"use strict";

var config = require("../config.js");
var PlainLocalStorageDriver = require("./PlainLocalStorageDriver.js");

class EncryptedLocalStorageDriver extends PlainLocalStorageDriver {
  /**
   * Set data into storage engine
   */
  set(key, value) {
    this.storage.setItem(
      this.getKey(key),
      config.getCacheConfig("encryption")?.encrypt(value)
    );
    return this;
  }
  /**
   * Get vale from storage engine
   */
  get(key, defaultValue = null) {
    let value = this.storage.getItem(this.getKey(key));
    return value
      ? config.getCacheConfig("encryption")?.decrypt(value)
      : defaultValue;
  }
  /**
   * Remove key from storage
   */
  remove(key) {
    this.storage.removeItem(this.getKey(key));
    return this;
  }
}

module.exports = EncryptedLocalStorageDriver;
